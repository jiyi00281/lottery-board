<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>投注策略模拟</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        #results { background-color: #f4f4f4; padding: 10px; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>投注策略模拟</h1>
    <button onclick="runSimulation()">开始模拟</button>
    <div id="results"></div>

    <script>
        class BettingStrategy {
            constructor(initialBalance = 1000) {
                this.balance = initialBalance;
                this.baseBet = 50.0;
                this.winStreak = 0;
                this.lossStreak = 0;
                this.totalRounds = 0;
            }

            calculateBetAmount() {
                const maxBet = this.balance * 0.03;
                let bet;

                if (this.winStreak > 0) {
                    bet = this.baseBet * (1 + this.winStreak * 0.1);
                } else if (this.lossStreak > 0) {
                    bet = this.baseBet * (1 - this.lossStreak * 0.15);
                } else {
                    bet = this.baseBet;
                }

                return Math.min(bet, maxBet);
            }

            determineBetDirection() {
                const baseProb = 0.525;

                if (this.winStreak > 2) return "反向";
                if (this.lossStreak > 2) return "正向";

                return Math.random() < baseProb ? "正向" : "反向";
            }

            updateResult(result, actualBetAmount) {
                this.totalRounds++;

                if (result === "赢") {
                    this.balance += actualBetAmount;
                    this.winStreak++;
                    this.lossStreak = 0;
                } else {
                    this.balance -= actualBetAmount;
                    this.lossStreak++;
                    this.winStreak = 0;
                }
            }

            getNextRoundStrategy() {
                const betAmount = this.calculateBetAmount();
                const betDirection = this.determineBetDirection();

                return {
                    投注金额: Number(betAmount.toFixed(2)),
                    投注方向: betDirection,
                    当前余额: Number(this.balance.toFixed(2))
                };
            }
        }

        function simulateBettingRounds(rounds = 10) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = ''; // 清空之前的结果

            const strategy = new BettingStrategy(1000);
            let output = `初始资金: ${strategy.balance}<br>`;

            for (let round = 1; round <= rounds; round++) {
                // 获取本轮策略
                const roundStrategy = strategy.getNextRoundStrategy();
                
                // 模拟输赢（55%概率赢）
                const result = Math.random() < 0.55 ? "赢" : "输";
                
                // 更新策略
                strategy.updateResult(result, roundStrategy.投注金额);

                // 记录结果
                output += `<br>第${round}轮:<br>`;
                output += `投注金额: ${roundStrategy.投注金额}<br>`;
                output += `投注方向: ${roundStrategy.投注方向}<br>`;
                output += `结果: ${result}<br>`;
                output += `当前余额: ${strategy.balance}<br>`;
            }

            output += `<br>最终资金: ${strategy.balance}`;
            resultsDiv.innerHTML = output;
        }

        function runSimulation() {
            // 设置随机数种子
            Math.seedrandom && Math.seedrandom('42');
            simulateBettingRounds();
        }
    </script>

    <!-- 可选：引入随机数种子库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script>
</body>
</html>
