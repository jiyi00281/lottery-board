<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>动态投注策略预测</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        #results { margin-top: 20px; }
        .round { margin-bottom: 10px; padding: 10px; background-color: #f4f4f4; }
        .win { color: green; }
        .loss { color: red; }
    </style>
</head>
<body>
    <h2>动态投注策略预测</h2>
    
    <div>
        <label>初始资金: <input type="number" id="initialBalance" value="1000"></label>
    </div>

    <div>
        <label>本轮投注金额: <input type="number" id="betAmount" value="30"></label>
    </div>

    <div>
        <label>本轮投注方向: 
            <select id="betDirection">
                <option value="正向">正向</option>
                <option value="反向">反向</option>
            </select>
        </label>
    </div>

    <div>
        <label>本轮结果: 
            <select id="roundResult">
                <option value="赢">赢</option>
                <option value="输">输</option>
            </select>
        </label>
    </div>

    <button onclick="processRound()">提交本轮结果</button>

    <div id="results"></div>

    <script>
        class DynamicBettingStrategy {
            constructor(initialBalance) {
                this.balance = initialBalance;
                this.baseBet = 30;
                this.winStreak = 0;
                this.lossStreak = 0;
                this.rounds = [];
            }

            calculateBetAmount() {
                const maxBet = this.balance * 0.03;
                let bet;

                if (this.winStreak > 0) {
                    bet = this.baseBet * (1 + this.winStreak * 0.1);
                } else if (this.lossStreak > 0) {
                    bet = this.baseBet * (1 - this.lossStreak * 0.15);
                } else {
                    bet = this.baseBet;
                }

                return Math.min(bet, maxBet);
            }

            determineBetDirection() {
                if (this.winStreak > 2) return "反向";
                if (this.lossStreak > 2) return "正向";
                return Math.random() < 0.525 ? "正向" : "反向";
            }

            updateStrategy(result, betAmount) {
                if (result === "赢") {
                    this.balance += betAmount;
                    this.winStreak++;
                    this.lossStreak = 0;
                } else {
                    this.balance -= betAmount;
                    this.lossStreak++;
                    this.winStreak = 0;
                }
            }

            predictNextRound() {
                return {
                    预测投注金额: Number(this.calculateBetAmount().toFixed(2)),
                    预测投注方向: this.determineBetDirection(),
                    当前余额: Number(this.balance.toFixed(2))
                };
            }
        }

        let strategy;

        function initStrategy() {
            const initialBalance = Number(document.getElementById('initialBalance').value);
            strategy = new DynamicBettingStrategy(initialBalance);
            document.getElementById('results').innerHTML = `初始资金: ${initialBalance}`;
        }

        function processRound() {
            if (!strategy) {
                initStrategy();
            }

            const betAmount = Number(document.getElementById('betAmount').value);
            const betDirection = document.getElementById('betDirection').value;
            const roundResult = document.getElementById('roundResult').value;

            // 更新策略
            strategy.updateStrategy(roundResult, betAmount);

            // 记录本轮结果
            const roundInfo = `
                <div class="round ${roundResult === '赢' ? 'win' : 'loss'}">
                    第${strategy.rounds.length + 1}轮:<br>
                    投注金额: ${betAmount}<br>
                    投注方向: ${betDirection}<br>
                    结果: ${roundResult}<br>
                    当前余额: ${strategy.balance.toFixed(2)}
                </div>
            `;
            document.getElementById('results').innerHTML += roundInfo;

            // 预测下一轮
            const nextRound = strategy.predictNextRound();
            document.getElementById('betAmount').value = nextRound.预测投注金额;
            document.getElementById('betDirection').value = nextRound.预测投注方向;
        }

        // 初始化
        initStrategy();
    </script>
</body>
</html>
