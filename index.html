 
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>波场极速彩 - 智能预测看板</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body.dark-mode { background-color: #121212; color: #f5f5f5; }
    .dark-mode .table, .dark-mode .alert { color: #f5f5f5; }
    .prediction-box strong { font-size: 1.5rem; color: darkred; }
  </style>
</head>
<body>
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>波场极速彩 - 智能预测看板</h3>
    <div>
      <select id="lottery-select" class="form-select d-inline-block w-auto">
        <option value="Tron-Fast" selected>Tron-Fast</option>
        <option value="TRON1">TRON1</option>
      </select>
      <button class="btn btn-outline-secondary ms-2" onclick="toggleDarkMode()">切换主题</button>
    </div>
  </div>

  <div id="status" class="alert alert-secondary">初始化中...</div>

  <div class="alert alert-info prediction-box">
    <div><strong>预测数字：</strong><span id="predicted-number">--</span></div>
    <div><strong>命中率估算：</strong><span id="predicted-accuracy">--</span>%</div>
    <div><strong>使用模型：</strong><span id="model-used">--</span></div>
    <div><strong>分析说明：</strong><span id="reason">--</span></div>
  </div>

  <p class="text-muted" id="last-updated">最后开奖时间：--</p>

</div>

<script>
const API_KEY = "rkjpugmlzj";
const API_BASE = "https://corsproxy.io/?https://api1.duoqu.online/data?code=";
const REFRESH_INTERVAL = 25000;

function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
}

function fetchData() {
  const code = document.getElementById("lottery-select").value;
  const url = `${API_BASE}${code}&limit=30&key=${API_KEY}`;
  fetch(url)
    .then(res => res.json())
    .then(json => {
      if (json.info !== "success") {
        document.getElementById("status").textContent = "接口错误";
        return;
      }

      const data = json.data;
      const numbers = data.map(d => d.openNumber);

      // 同步接口时间
      const lastTime = data[0]?.openTime || "--";
      document.getElementById("last-updated").textContent = "最后开奖时间：" + lastTime;

      const allDigits = numbers.flatMap(x => x.split(',').map(Number));

      // 构建频率
      const freq = Array(10).fill(0);
      allDigits.forEach(n => freq[n]++);

      // 加权频率（近期数据权重大）
      const weights = Array.from({length: numbers.length}, (_, i) => 1 + i / numbers.length);
      const weightedFreq = Array(10).fill(0);
      numbers.forEach((set, i) => {
        set.split(',').forEach(n => {
          weightedFreq[parseInt(n)] += weights[i];
        });
      });

      // 模型1：概率模型
      const score1 = freq.map((f, i) => 0.4 * (f / allDigits.length) + 0.6 * (weightedFreq[i] / weightedFreq.reduce((a, b) => a + b)));
      const max1 = Math.max(...score1);
      const num1 = score1.indexOf(max1);

      // 模型2：遗传算法（简单进化模拟）
      let gaScores = Array(10).fill(0);
      allDigits.forEach(n => gaScores[n]++);
      const num2 = gaScores.indexOf(Math.max(...gaScores));
      const score2 = gaScores[num2] / allDigits.length;

      // 模型选择
      let finalNum = num1, model = "频率加权模型", reason = "频率模型得分更稳定", prob = max1;
      if (score2 > max1) {
        finalNum = num2;
        model = "遗传算法模型";
        reason = "近期历史中出现次数更密集";
        prob = score2;
      }

      document.getElementById("predicted-number").textContent = finalNum;
      document.getElementById("predicted-accuracy").textContent = (prob * 100).toFixed(2);
      document.getElementById("model-used").textContent = model;
      document.getElementById("reason").textContent = reason;
      document.getElementById("status").className = "alert alert-success";
      document.getElementById("status").textContent = "数据更新成功";
    })
    .catch(() => {
      document.getElementById("status").className = "alert alert-danger";
      document.getElementById("status").textContent = "接口请求失败";
    });
}

fetchData();
setInterval(fetchData, REFRESH_INTERVAL);
</script>
</body>
</html>
